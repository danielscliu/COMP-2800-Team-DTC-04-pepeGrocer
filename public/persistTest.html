<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Persistence Test</title>
</head>
<!--AJAX CDN-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<!--################################################FIREBASE ZONE. DO NOT TOUCH ####################################-->
<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/7.2.2/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/7.2.2/firebase-auth.js"></script>


<script src="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.css"/>

<!--firebase API config files-->
<script>
    var firebaseConfig = {
        apiKey: "AIzaSyBqB5QHNRRquDJxd9OiXXa9c33dI4zDSDA",
        authDomain: "firebaetest-6e21a.firebaseapp.com",
        databaseURL: "https://firebaetest-6e21a.firebaseio.com",
        projectId: "firebaetest-6e21a",
        storageBucket: "firebaetest-6e21a.appspot.com",
        messagingSenderId: "763860546362",
        appId: "1:763860546362:web:35a3ed2ac35df4abd5d603",
        measurementId: "G-V56860GVZL"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
</script>
<!--################################################ END FIREBASE ZONE ####################################-->
<script>
    // firebase.auth().currentUser
    //     .getIdToken(forceRefresh)
    //     .then(function (idToken) {
    //         console.log("ID OK");
    //
    //     }).catch(function (error) {
    //     // Handle error
    // });
</script>

<!--CHECK LOGIN 2?-->
<script>
    firebase.auth().onAuthStateChanged(function (user) {
        if (user) {
            console.log("loggedin");
            $.ajax({
                type: 'POST',
                data: {
                    "uid" : user.uid
                },
                url: '/auth?uid=' + user.uid
            })

        } else {
            console.log("NOPE not logged in");
            window.location.href = "/";
        }
    });
</script>
<script>
    const logout = document.querySelector("#logoutButton");
    logout.addEventListener('click', (e) => {
        e.preventDefault();
        firebase.auth().signOut();
        console.log("user signed out");
        window.location.href = "/";
    });
</script>

<body>
<a href="#"id="logoutButton">Logout</a>
</body>
<!--LOGOUT-->

<!--CHECK LOGIN-->


</html>